
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">HTML</span>

<span class="n">HTML</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;&lt;script&gt;</span>
<span class="s1">code_show=true; </span>
<span class="s1">function code_toggle() {</span>
<span class="s1"> if (code_show){</span>
<span class="s1"> $(&#39;div.input&#39;).hide();</span>
<span class="s1"> $(&#39;div.prompt&#39;).hide();</span>
<span class="s1"> } else {</span>
<span class="s1"> $(&#39;div.input&#39;).show();</span>
<span class="s1">$(&#39;div.prompt&#39;).show();</span>
<span class="s1"> }</span>
<span class="s1"> code_show = !code_show</span>
<span class="s1">} </span>
<span class="s1">$( document ).ready(code_toggle);</span>
<span class="s1">&lt;/script&gt;</span>
<span class="s1">&lt;form action=&quot;javascript:code_toggle()&quot;&gt;&lt;input type=&quot;submit&quot; value=&quot;Code Toggle&quot;&gt;&lt;/form&gt;&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[8]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
<script>
code_show=true; 
function code_toggle() {
 if (code_show){
 $('div.input').hide();
 $('div.prompt').hide();
 } else {
 $('div.input').show();
$('div.prompt').show();
 }
 code_show = !code_show
} 
$( document ).ready(code_toggle);
</script>
<form action="javascript:code_toggle()"><input type="submit" value="Code Toggle"></form>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">HTML</span>

<span class="n">HTML</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;{</span><span class="si">% i</span><span class="s1">nclude jupyter_benchmark_table.html num=&quot;[1, 2]&quot; revision=0 %}&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[4]:</div>


<div class="output_html rendered_html output_subarea output_execute_result">
{% include jupyter_benchmark_table.html num="[1, 2]" revision=0 %}
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Table-of-Contents">Table of Contents<a class="anchor-link" href="#Table-of-Contents">&#182;</a></h1><ul>
<li><a href="#Challenge-Problems">Challenge Problems</a><ul>
<li><a href="#1.-Spinodal-Decomposition---Cahn-Hilliard">1. Spinodal Decomposition - Cahn-Hilliard</a><ul>
<li><a href="#1.1-Parameter-Values">1.1 Parameter Values</a></li>
<li><a href="#1.2-Initial-Conditions">1.2 Initial Conditions</a></li>
<li><a href="#1.3-Domains">1.3 Domains</a><ul>
<li><a href="#1.a-Square-Periodic">1.a Square Periodic</a></li>
<li><a href="#1.b-No-Flux">1.b No Flux</a></li>
<li><a href="#1.c-T-Shape-No-Flux">1.c T-Shape No Flux</a></li>
<li><a href="#1.d-Sphere">1.d Sphere</a></li>
</ul>
</li>
<li><a href="#1.4-Tasks">1.4 Tasks</a></li>
</ul>
</li>
<li><a href="#2.-Ostwald-Ripening----coupled-Cahn-Hilliard-and-Allen-Cahn-equations">2. Ostwald Ripening -- coupled Cahn-Hilliard and Allen-Cahn equations</a><ul>
<li><a href="#2.1-Parameter-Values">2.1 Parameter Values</a></li>
<li><a href="#2.2-Initial-Conditions">2.2 Initial Conditions</a></li>
<li><a href="#2.3-Domains">2.3 Domains</a><ul>
<li><a href="#2.a-Square-Periodic">2.a Square Periodic</a></li>
<li><a href="#2.b-No-Flux">2.b No Flux</a></li>
<li><a href="#2.c-T-Shape-No-Flux">2.c T-Shape No Flux</a></li>
<li><a href="#2.d-Sphere">2.d Sphere</a></li>
</ul>
</li>
<li><a href="#2.4-Tasks">2.4 Tasks</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Challenge-Problems">Challenge Problems<a class="anchor-link" href="#Challenge-Problems">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the first hackathon there are two challenge problems, a spinodal decomposition problem and an Ostwald ripening problem. The only solutions included here currently are with FiPy.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.-Spinodal-Decomposition---Cahn-Hilliard">1. Spinodal Decomposition - Cahn-Hilliard<a class="anchor-link" href="#1.-Spinodal-Decomposition---Cahn-Hilliard">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The free energy density is given by,</p>
$$ f = f_0 \left[ c \left( \vec{r} \right) \right] + \frac{\kappa}{2} \left| \nabla c \left( \vec{r} \right) \right|^2 $$<p>where $f_0$ is the bulk free energy density given by,</p>
$$ f_0\left[ c \left( \vec{r} \right) \right] =
   - \frac{A}{2} \left(c - c_m\right)^2
   + \frac{B}{4} \left(c - c_m\right)^4
   + \frac{c_{\alpha}}{4} \left(c - c_{\alpha} \right)^4
   + \frac{c_{\beta}}{4} \left(c - c_{\beta} \right)^4 $$<p>where $c_m = \frac{1}{2} \left( c_{\alpha} + c_{\beta} \right)$ and $c_{\alpha}$ and $c_{\beta}$ are the concentrations at which the bulk free energy density has minima (corresponding to the solubilities in the matrix phase and the second phase, respectively).</p>
<p>The time evolution of the concentration field, $c$, is given by the Cahn-Hilliard equation:</p>
$$ \frac{\partial c}{\partial t} = \nabla \cdot  \left[
       D \left( c \right) \nabla \left( \frac{ \partial f_0 }{ \partial c} - \kappa \nabla^2 c \right)
   \right] $$<p>where $D$ is the diffusivity.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.1-Parameter-Values">1.1 Parameter Values<a class="anchor-link" href="#1.1-Parameter-Values">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Use the following parameter values.</p>
<table width="200">
<tr>
<td> $c_{\alpha}$ </td>
<td> 0.05 </td>
</tr>
<tr>
<td> $c_{\beta}$ </td>
<td> 0.95 </td>
</tr>
<tr>
<td> A </td>
<td> 2.0 </td>
</tr>
<tr>
<td> $\kappa$ </td>
<td> 2.0 </td>
</tr>
</table><p>with</p>
$$ B = \frac{A}{\left( c_{\alpha} - c_m \right)^2} $$$$ D = D_{\alpha} = D_{\beta} = \frac{2}{c_{\beta} - c_{\alpha}} $$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.2-Initial-Conditions">1.2 Initial Conditions<a class="anchor-link" href="#1.2-Initial-Conditions">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Set $c\left(\vec{r}, t\right)$ such that</p>
$$ c\left(\vec{r}, 0\right) = \bar{c}_0 + \epsilon \cos \left( \vec{q} \cdot \vec{r} \right) $$<p>where</p>
<table width="200">
<tr>
<td> $\bar{c}_0$ </td>
<td> 0.45 </td>
</tr>
<tr>
<td> $\vec{q}$ </td>
<td> $\left(\sqrt{2},\sqrt{3}\right)$ </td>
</tr>
<tr>
<td> $\epsilon$ </td>
<td> 0.01 </td>
</tr>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.3-Domains">1.3 Domains<a class="anchor-link" href="#1.3-Domains">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="1.a-Square-Periodic">1.a Square Periodic<a class="anchor-link" href="#1.a-Square-Periodic">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>2D square domain with $L_x = L_y = 200$ and periodic boundary conditions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">SVG</span>
<span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;../images/block1.svg&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[3]:</div>


<div class="output_svg output_subarea output_execute_result">
<svg height="212px" version="1.1" width="232px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs/><g transform="translate(0.5,0.5)"><rect fill="#000000" height="150" pointer-events="none" stroke="#000000" width="150" x="71" y="51"/><path d="M 51 194.63 L 51 57.37" fill="none" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 51 199.88 L 47.5 192.88 L 51 194.63 L 54.5 192.88 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 51 52.12 L 54.5 59.12 L 51 57.37 L 47.5 59.12 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 214.63 31 L 77.37 31" fill="none" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 219.88 31 L 212.88 34.5 L 214.63 31 L 212.88 27.5 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 72.12 31 L 79.12 27.5 L 77.37 31 L 79.12 34.5 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><g transform="translate(14.5,124.5)"><switch><foreignObject height="12" pointer-events="all" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;" width="13"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 16px; max-width: 36px; width: 13px; white-space: normal; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><div style="display:inline-block;text-align:inherit;text-decoration:inherit;" xmlns="http://www.w3.org/1999/xhtml">Ly</div></div></foreignObject><text fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" x="7" y="12">Ly</text></switch></g><g transform="translate(134.5,4.5)"><switch><foreignObject height="12" pointer-events="all" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;" width="13"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 16px; max-width: 36px; width: 13px; white-space: normal; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><div style="display:inline-block;text-align:inherit;text-decoration:inherit;" xmlns="http://www.w3.org/1999/xhtml">Lx</div></div></foreignObject><text fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" x="7" y="12">Lx</text></switch></g></g></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="1.b-No-Flux">1.b No Flux<a class="anchor-link" href="#1.b-No-Flux">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>2D square domain with $L_x = L_y = 200$ and zero flux boundary conditions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="1.c-T-Shape-No-Flux">1.c T-Shape No Flux<a class="anchor-link" href="#1.c-T-Shape-No-Flux">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>T-shaped reiong with zero flux boundary conditions with $a=b=100$ and $c=d=20.$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">SVG</span>
<span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;../images/t-shape.svg&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[4]:</div>


<div class="output_svg output_subarea output_execute_result">
<svg height="235px" version="1.1" width="217px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs/><g transform="translate(0.5,0.5)"><rect fill="#000000" height="40" pointer-events="none" stroke="#000000" width="150" x="56" y="43"/><path d="M 36 76.63 L 36 49.37" fill="none" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 36 81.88 L 32.5 74.88 L 36 76.63 L 39.5 74.88 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 36 44.12 L 39.5 51.12 L 36 49.37 L 32.5 51.12 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 199.63 23 L 62.37 23" fill="none" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 204.88 23 L 197.88 26.5 L 199.63 23 L 197.88 19.5 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 57.12 23 L 64.12 19.5 L 62.37 23 L 64.12 26.5 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><g transform="translate(122.5,4.5)"><switch><foreignObject height="12" pointer-events="all" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;" width="7"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 16px; max-width: 36px; width: 7px; white-space: normal; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><div style="display:inline-block;text-align:inherit;text-decoration:inherit;" xmlns="http://www.w3.org/1999/xhtml">b</div></div></foreignObject><text fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" x="4" y="12">b</text></switch></g><rect fill="#000000" height="110" pointer-events="none" stroke="#000000" width="40" x="111" y="83"/><path d="M 86 186.63 L 86 89.37" fill="none" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 86 191.88 L 82.5 184.88 L 86 186.63 L 89.5 184.88 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 86 84.12 L 89.5 91.12 L 86 89.37 L 82.5 91.12 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 144.63 213 L 117.37 213" fill="none" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 149.88 213 L 142.88 216.5 L 144.63 213 L 142.88 209.5 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 112.12 213 L 119.12 209.5 L 117.37 213 L 119.12 216.5 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><g transform="translate(72.5,141.5)"><switch><foreignObject height="12" pointer-events="all" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;" width="7"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 16px; max-width: 36px; width: 7px; white-space: normal; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><div style="display:inline-block;text-align:inherit;text-decoration:inherit;" xmlns="http://www.w3.org/1999/xhtml">a</div></div></foreignObject><text fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" x="4" y="12">a</text></switch></g><g transform="translate(17.5,56.5)"><switch><foreignObject height="12" pointer-events="all" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;" width="6"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 16px; max-width: 36px; width: 7px; white-space: normal; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><div style="display:inline-block;text-align:inherit;text-decoration:inherit;" xmlns="http://www.w3.org/1999/xhtml">c</div></div></foreignObject><text fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" x="3" y="12">c</text></switch></g><g transform="translate(127.5,216.5)"><switch><foreignObject height="12" pointer-events="all" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;" width="7"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 16px; max-width: 36px; width: 7px; white-space: normal; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><div style="display:inline-block;text-align:inherit;text-decoration:inherit;" xmlns="http://www.w3.org/1999/xhtml">d</div></div></foreignObject><text fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" x="4" y="12">d</text></switch></g></g></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="1.d-Sphere">1.d Sphere<a class="anchor-link" href="#1.d-Sphere">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Domain is the surface of a sphere with radius 100, but with initial conditions of</p>
$$ c\left(\theta, \phi, 0\right) = \bar{c}_0 + \epsilon \cos \left( \sqrt{233} \theta \right)
                                                        \sin \left( \sqrt{239} \phi \right) $$<p>where $\theta$ and $\phi$ are the polar and azimuthal angles in a spherical coordinate system. $\bar{c}_0$ and $\epsilon$ are given by the values in the table above.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.4-Tasks">1.4 Tasks<a class="anchor-link" href="#1.4-Tasks">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Your task for each domain,</p>
<ol>
<li><p>Calculate the time evolution of the concentration -- store concentration at time steps to make a movie</p>
</li>
<li><p>Plot the free energy as a function of time steps until you judge that convergence or a local equilibrium has been reached.</p>
</li>
<li><p>Present wall clock time for the calculations, and wall clock time per core used in the calculation.</p>
</li>
<li><p>For domain a. above, demonstrate that the solution is robust with respect to meshing by refining the mesh (e.g. reduce the mesh size by about a factor of $\sqrt{2}$ in linear dimensions -- use whatever convenient way you have to refine the mesh without exploding the computational time).</p>
</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.-Ostwald-Ripening----coupled-Cahn-Hilliard-and-Allen-Cahn-equations">2. Ostwald Ripening -- coupled Cahn-Hilliard and Allen-Cahn equations<a class="anchor-link" href="#2.-Ostwald-Ripening----coupled-Cahn-Hilliard-and-Allen-Cahn-equations">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Expanded problem in that the phase field, described by variables $\eta_i$, is now coupled to the concentration field $c$. The Ginzberg-Landau free energy density is now taken to be,</p>
$$ f = f_0 \left[ C \left( \vec{r} \right), \eta_1, ... , \eta_p \right]
+ \frac{\kappa_C}{2} \left[ \nabla  C \left( \vec{r} \right) \right]^2 +
\sum_{i=1}^p \frac{\kappa_C}{2} \left[ \nabla  \eta_i \left( \vec{r} \right) \right]^2
$$<p>Here, $f_0$ is a bulk free energy density,</p>
$$ f_0 \left[ C \left( \vec{r} \right), \eta_1, ... , \eta_p \right] 
= f_1 \left( C \right) + \sum_{i=1}^p f_2 \left( C, \eta_i \right)
+ \sum_{i=1}^p \sum_{j\ne i}^p f_3 \left( \eta_j, \eta_i \right) $$<p>Here, $ f_1 \left( C \right) $ is the free energy density due to the concentration field, $C$, with local minima at $C_{\alpha}$ and $C_{\beta}$ corresponding to the solubilities in the matrix phase and the second phase, respectively; $f_2\left(C , \eta_i \right)$ is an interaction term between the concentration field and the phase fields, and $f_3 \left( \eta_i, \eta_j \right)$ is the free energy density of the phase fields. Simple models for these free energy densities are,</p>
$$ f_1\left( C \right) =
   - \frac{A}{2} \left(C - C_m\right)^2
   + \frac{B}{4} \left(C - C_m\right)^4
   + \frac{D_{\alpha}}{4} \left(C - C_{\alpha} \right)^4
   + \frac{D_{\beta}}{4} \left(C - C_{\beta} \right)^4 $$<p>where</p>
$$ C_m = \frac{1}{2} \left(C_{\alpha} + C_{\beta} \right) $$<p>and</p>
$$ f_2 \left( C, \eta_i \right) = - \frac{\gamma}{2} \left( C - C_{\alpha} \right)^2 \eta_i^2 + \frac{\beta}{2} \eta_i^4 $$<p>where</p>
$$ f_3 \left( \eta_i, \eta_j \right) = \frac{ \epsilon_{ij} }{2} \eta_i^2 \eta_j^2, i \ne j $$<p>The time evolution of the system is now given by coupled Cahn-Hilliard and Allen-Cahn (time dependent Gizberg-Landau) equations for the conserved concentration field and the non-conserved phase fields:</p>
$$
\begin{eqnarray}
\frac{\partial C}{\partial t} &=& \nabla \cdot  \left \{
       D \nabla \left[ \frac{\delta F}{\delta C} \right] \right \} \\
 &=& D \left[ -A + 3 B \left( C- C_m \right)^2 + 3 D_{\alpha} \left( C - C_{\alpha} \right)^2 + 3 D_{\beta} \left( C - C_{\beta} \right)^2 \right] \nabla^2 C \\
& & -D \gamma \sum_{i=1}^{p} \left[ \eta_i^2 \nabla^2 C + 4 \nabla C \cdot \nabla \eta_i + 2 \left( C - C_{\alpha} \right) \nabla^2 \eta_i \right] - D \kappa_C \nabla^4 C
\end{eqnarray}
$$<p>and the phase field equations</p>
$$
\begin{eqnarray}
\frac{\partial \eta_i}{\partial t} &=& - L_i \frac{\delta F}{\delta \eta_i} \\
          &=& \frac{\partial f_2}{\delta \eta_i} + \frac{\partial f_3}{\delta \eta_i} - \kappa_i \nabla^2 \eta_i \left(\vec{r}, t\right) \\
          &=& L_i \gamma \left( C - C_{\alpha} \right)^2 \eta_i - L_i \beta \eta_i^3 - L_i \eta_i \sum_{j\ne i}^{p} \epsilon_{ij} \eta^2_j + L_i \kappa_i \nabla^2 \eta_i
\end{eqnarray}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.1-Parameter-Values">2.1 Parameter Values<a class="anchor-link" href="#2.1-Parameter-Values">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Use the following parameter values.</p>
<table width="200">
<tr>
<td> $C_{\alpha}$ </td>
<td> 0.05 </td>
</tr>
<tr>
<td> $C_{\beta}$ </td>
<td> 0.95 </td>
</tr>
<tr>
<td> A </td>
<td> 2.0 </td>
</tr>
<tr>
<td> $\kappa_i$ </td>
<td> 2.0 </td>
</tr>
<tr>
<td> $\kappa_j$ </td>
<td> 2.0 </td>
</tr>
<tr>
<td> $\kappa_k$ </td>
<td> 2.0 </td>
</tr>
<tr>
<td> $\epsilon_{ij}$ </td>
<td> 3.0 </td>
</tr>
<tr>
<td> $\beta$ </td>
<td> 1.0 </td>
</tr>
<tr>
<td> $p$ </td>
<td> 10 </td>
</tr>
</table><p>with</p>
$$ B = \frac{A}{\left( C_{\alpha} - C_m \right)^2} $$$$ \gamma = \frac{2}{\left(C_{\beta} - C_{\alpha}\right)^2} $$$$ D = D_{\alpha} = D_{\beta} = \frac{\gamma}{\delta^2} $$<p>The diffusion coefficient, $D$, is constant and isotropic and the same (unity) for both phases; the mobility-related constants, $L_i$, are the same (unity) for all phase fields.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.2-Initial-Conditions">2.2 Initial Conditions<a class="anchor-link" href="#2.2-Initial-Conditions">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Set $c\left(\vec{r}, t\right)$ such that</p>
$$ 
\begin{eqnarray}
c\left(\vec{r}, 0\right) &=& \bar{c}_0 + \epsilon \cos \left( \vec{q} \cdot \vec{r} \right) \\
\eta_i\left(\vec{r}, 0\right) &=& \bar{\eta}_0 + 0.01 \epsilon_i \cos^2 \left( \vec{q} \cdot \vec{r} \right)
\end{eqnarray}
$$<p>where</p>
<table width="200">
<tr>
<td> $\bar{c}_0$ </td>
<td> 0.5 </td>
</tr>
<tr>
<td> $\vec{q}$ </td>
<td> $\left(\sqrt{2},\sqrt{3}\right)$ </td>
</tr>
<tr>
<td> $\epsilon$ </td>
<td> 0.01 </td>
</tr>
<tr>
<td> $\vec{q}_i$ </td>
<td> $\left( \sqrt{23 + i}, \sqrt{149 + i} \right)$ </td>
</tr>
<tr>
<td> $\epsilon_i$ </td>
<td> 0.979285, 0.219812,    0.837709,   0.695603,   0.225115,   
0.389266,   0.585953,   0.614471,   0.918038,   0.518569 </td>
</tr>
<tr>
<td> $\eta_0$ </td>
<td> 0.0 </td>
</tr>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.3-Domains">2.3 Domains<a class="anchor-link" href="#2.3-Domains">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="2.a-Square-Periodic">2.a Square Periodic<a class="anchor-link" href="#2.a-Square-Periodic">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>2D square domain with $L_x = L_y = 200$ and periodic boundary conditions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">SVG</span>
<span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;../images/block1.svg&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[5]:</div>


<div class="output_svg output_subarea output_execute_result">
<svg height="212px" version="1.1" width="232px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs/><g transform="translate(0.5,0.5)"><rect fill="#000000" height="150" pointer-events="none" stroke="#000000" width="150" x="71" y="51"/><path d="M 51 194.63 L 51 57.37" fill="none" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 51 199.88 L 47.5 192.88 L 51 194.63 L 54.5 192.88 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 51 52.12 L 54.5 59.12 L 51 57.37 L 47.5 59.12 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 214.63 31 L 77.37 31" fill="none" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 219.88 31 L 212.88 34.5 L 214.63 31 L 212.88 27.5 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 72.12 31 L 79.12 27.5 L 77.37 31 L 79.12 34.5 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><g transform="translate(14.5,124.5)"><switch><foreignObject height="12" pointer-events="all" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;" width="13"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 16px; max-width: 36px; width: 13px; white-space: normal; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><div style="display:inline-block;text-align:inherit;text-decoration:inherit;" xmlns="http://www.w3.org/1999/xhtml">Ly</div></div></foreignObject><text fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" x="7" y="12">Ly</text></switch></g><g transform="translate(134.5,4.5)"><switch><foreignObject height="12" pointer-events="all" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;" width="13"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 16px; max-width: 36px; width: 13px; white-space: normal; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><div style="display:inline-block;text-align:inherit;text-decoration:inherit;" xmlns="http://www.w3.org/1999/xhtml">Lx</div></div></foreignObject><text fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" x="7" y="12">Lx</text></switch></g></g></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="2.b-No-Flux">2.b No Flux<a class="anchor-link" href="#2.b-No-Flux">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>2D square domain with $L_x = L_y = 200$ and zero flux boundary conditions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="2.c-T-Shape-No-Flux">2.c T-Shape No Flux<a class="anchor-link" href="#2.c-T-Shape-No-Flux">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>T-shaped reiong with zero flux boundary conditions with $a=b=100$ and $c=d=20.$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">SVG</span>
<span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;../images/t-shape.svg&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[7]:</div>


<div class="output_svg output_subarea output_execute_result">
<svg height="235px" version="1.1" width="217px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs/><g transform="translate(0.5,0.5)"><rect fill="#000000" height="40" pointer-events="none" stroke="#000000" width="150" x="56" y="43"/><path d="M 36 76.63 L 36 49.37" fill="none" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 36 81.88 L 32.5 74.88 L 36 76.63 L 39.5 74.88 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 36 44.12 L 39.5 51.12 L 36 49.37 L 32.5 51.12 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 199.63 23 L 62.37 23" fill="none" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 204.88 23 L 197.88 26.5 L 199.63 23 L 197.88 19.5 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 57.12 23 L 64.12 19.5 L 62.37 23 L 64.12 26.5 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><g transform="translate(122.5,4.5)"><switch><foreignObject height="12" pointer-events="all" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;" width="7"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 16px; max-width: 36px; width: 7px; white-space: normal; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><div style="display:inline-block;text-align:inherit;text-decoration:inherit;" xmlns="http://www.w3.org/1999/xhtml">b</div></div></foreignObject><text fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" x="4" y="12">b</text></switch></g><rect fill="#000000" height="110" pointer-events="none" stroke="#000000" width="40" x="111" y="83"/><path d="M 86 186.63 L 86 89.37" fill="none" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 86 191.88 L 82.5 184.88 L 86 186.63 L 89.5 184.88 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 86 84.12 L 89.5 91.12 L 86 89.37 L 82.5 91.12 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 144.63 213 L 117.37 213" fill="none" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 149.88 213 L 142.88 216.5 L 144.63 213 L 142.88 209.5 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><path d="M 112.12 213 L 119.12 209.5 L 117.37 213 L 119.12 216.5 Z" fill="#000000" pointer-events="none" stroke="#000000" stroke-miterlimit="10"/><g transform="translate(72.5,141.5)"><switch><foreignObject height="12" pointer-events="all" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;" width="7"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 16px; max-width: 36px; width: 7px; white-space: normal; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><div style="display:inline-block;text-align:inherit;text-decoration:inherit;" xmlns="http://www.w3.org/1999/xhtml">a</div></div></foreignObject><text fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" x="4" y="12">a</text></switch></g><g transform="translate(17.5,56.5)"><switch><foreignObject height="12" pointer-events="all" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;" width="6"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 16px; max-width: 36px; width: 7px; white-space: normal; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><div style="display:inline-block;text-align:inherit;text-decoration:inherit;" xmlns="http://www.w3.org/1999/xhtml">c</div></div></foreignObject><text fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" x="3" y="12">c</text></switch></g><g transform="translate(127.5,216.5)"><switch><foreignObject height="12" pointer-events="all" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;" width="7"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 16px; max-width: 36px; width: 7px; white-space: normal; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><div style="display:inline-block;text-align:inherit;text-decoration:inherit;" xmlns="http://www.w3.org/1999/xhtml">d</div></div></foreignObject><text fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" x="4" y="12">d</text></switch></g></g></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="2.d-Sphere">2.d Sphere<a class="anchor-link" href="#2.d-Sphere">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Domain is the surface of a sphere with radius 100, but with initial conditions of</p>
$$ c\left(\theta, \phi, 0\right) = \bar{c}_0 + \epsilon \cos \left( \sqrt{233} \theta \right)
                                                        \sin \left( \sqrt{239} \phi \right) $$<p>and</p>
$$ \eta_i\left(\theta, \phi, 0\right) = \bar{\eta}_0 + 0.01 \epsilon_i \cos^2 \left( \sqrt{23 + i} \theta \right)
                                                        \sin^2 \left( \sqrt{149 + i} \phi \right) $$<p>where $\theta$ and $\phi$ are the polar and azimuthal angles in a spherical coordinate system and parameter values are in the table above.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.4-Tasks">2.4 Tasks<a class="anchor-link" href="#2.4-Tasks">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Your task for each domain,</p>
<ol>
<li><p>Calculate the time evolution of the concentration -- store concentration at time steps to make a movie</p>
</li>
<li><p>Plot the free energy as a function of time steps until you judge that convergence or a local equilibrium has been reached.</p>
</li>
<li><p>Present wall clock time for the calculations, and wall clock time per core used in the calculation.</p>
</li>
</ol>

</div>
</div>
</div>
 

